import e from"browser-acl";const t={install(t,n,l,s={}){const c="function"==typeof n?n:()=>n,u=Boolean(s.strict),d=Object.assign({acl:{strict:u},aliases:["role"],assumeGlobal:!u,caseMode:!0,debug:!1,directive:"can",failRoute:"/",helper:!0,strict:!1},s),f=o(d);let m=new e(d.acl);"function"==typeof l?l(m):l instanceof e&&(m=l),m.router=function(t){d.router=t;const o=(e,t,...o)=>t&&m.can(c(),e,t,...o)||!t&&!d.strict;t.beforeEach((t,r,a)=>{const i=((t,r,a)=>{let i=null;const n=t.reduce((t,n)=>t.then(t=>{if(!0!==t)return t;"string"==typeof n.fail&&(i=n.fail);const l=f(n),s="function"==typeof l?l(r,a,o):Promise.resolve(o(...(t=>{const[o,r=(d.assumeGlobal?e.GlobalRule:null)]=t.split(" ");return[o,r]})(l)));if(d.strict&&!(s instanceof Promise))throw new Error("$route.meta.can must return a promise in strict mode");return s}).catch(e=>(d.debug&&console.error(e),!1)),Promise.resolve(!0));return n.getFail=()=>i,n})(t.matched.filter(e=>e.meta&&f(e.meta)).map(e=>e.meta),t,r);i.then(e=>{if(!0===e)return a();let o=i.getFail()||d.failRoute;"$from"===o&&(o=r.path),a("function"==typeof o?o(t,r):o)})})},d.router&&m.router(d.router);const p=function(t,o,n){var l;const s=void 0!==(u=o.modifiers).disable?"disable":void 0!==u.readonly?"readonly":"hide";var u;let f,p,b,v;if(p=o.arg,Array.isArray(o.value)&&null!=(l=o.expression)&&l.startsWith("[")?[f,b,v]=o.modifiers.global?a(o):r(o):"string"==typeof o.value?[f,b,v]=i(o,n,d):p&&"object"==typeof o.value?(f=p,b=o.value,v=[]):void 0===o.value&&!o.modifiers.global&&d.assumeGlobal&&(f=p,b=e.GlobalRule,v=[]),d.assumeGlobal&&!b&&(b=e.GlobalRule,v=v||[],f=f||p),!f||!b)throw new Error("Missing verb or verb object");const y=m[(o.modifiers.some?"some":o.modifiers.every&&"every")||"can"](c(),f,b,...v),h=o.modifiers.not,g=t;t.hasAttribute("disabled")||(g.disabled=!1),t.hasAttribute("readOnly")||(g.readOnly=!1),(y&&h||!y&&!h)&&("hide"===s?function(e,t){const o=document.createComment(" ");Object.defineProperty(o,"setAttribute",{value:()=>{}}),t.text=" ",t.elm=o,t.isComment=!0,t.tag=void 0,t.data=t.data||{},t.data.directives=void 0,t.componentInstance&&(t.componentInstance.$el=o),e.parentNode&&e.parentNode.replaceChild(o,e)}(t,n):"disable"===s?g.disabled=!0:"readonly"===s&&(g.readOnly=!0))};if([d.directive,...d.aliases].forEach(e=>t.directive(e,p)),d.helper){const e="$"+d.directive;t.prototype[e]=function(e,t,...o){return m.can(c(),e,t,...o)},t.prototype[e].not=function(e,t,...o){return!m.can(c(),e,t,...o)},t.prototype[e].every=function(e,t,...o){return m.every(c(),e,t,...o)},t.prototype[e].some=function(e,t,...o){return m.some(c(),e,t,...o)}}}},o=e=>t=>[e.directive,...e.aliases||[]].map(e=>t[e]).filter(Boolean).shift(),r=({arg:e,value:t})=>[e||t[0],e?t[0]:t[1],t.slice(e?1:2)],a=({arg:t,value:o})=>[t||o[0],e.GlobalRule,t?o:o.slice(1)],i=({arg:e,value:t,modifiers:o},r,a)=>{let[i,n]=e?[e,t]:t.split(" ");if(n&&o.global)throw new Error("You cannot provide verb object and use global modifier at the same time");return"string"==typeof n&&a.caseMode&&n[0].match(/[a-z]/)&&"object"==typeof r.context&&(n=r.context.$data[n]),[i,n,[]]};export default t;
//# sourceMappingURL=index.modern.js.map
