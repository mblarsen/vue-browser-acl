import e from"browser-acl";var t={install:function(t,i,l,c){void 0===l&&(l=void 0),void 0===c&&(c={});var u="function"==typeof i?i:function(){return i},s=Boolean(c.strict),f=Object.assign({acl:{strict:s},aliases:["role"],assumeGlobal:!s,caseMode:!0,debug:!1,directive:"can",failRoute:"/",helper:!0,strict:!1},c),d=r(f),v=new e(f.acl);"function"==typeof l?l(v):l instanceof e&&(v=l),v.router=function(t){f.router=t;var r=function(e,t){var r;return t&&(r=v).can.apply(r,[u(),e,t].concat([].slice.call(arguments,2)))||!t&&!f.strict};t.beforeEach(function(t,o,a){var n=function(t,o,a){var n=null,i=t.reduce(function(t,i){return t.then(function(t){if(!0!==t)return t;"string"==typeof i.fail&&(n=i.fail);var l,c,u=d(i),s="function"==typeof u?u(o,a,r):Promise.resolve(r.apply(void 0,[(l=u.split(" "))[0],void 0===(c=l[1])?f.assumeGlobal?e.GlobalRule:null:c]));if(f.strict&&!(s instanceof Promise))throw new Error("$route.meta.can must return a promise in strict mode");return s}).catch(function(e){return f.debug&&console.error(e),!1})},Promise.resolve(!0));return i.getFail=function(){return n},i}(t.matched.filter(function(e){return e.meta&&d(e.meta)}).map(function(e){return e.meta}),t,o);n.then(function(e){if(!0===e)return a();var r=n.getFail()||f.failRoute;"$from"===r&&(r=o.path),a("function"==typeof r?r(t,o):r)})})},f.router&&v.router(f.router);var p=function(t,r,i){var l,c,s,d,p,m,b,y=void 0!==(b=r.modifiers).disable?"disable":void 0!==b.readonly?"readonly":"hide";if(d=r.arg,Array.isArray(r.value)&&null!=(l=r.expression)&&l.startsWith("[")){var h=r.modifiers.global?a(r):o(r);s=h[0],p=h[1],m=h[2]}else if("string"==typeof r.value){var g=n(r,i,f);s=g[0],p=g[1],m=g[2]}else d&&"object"==typeof r.value?(s=d,p=r.value,m=[]):void 0===r.value&&!r.modifiers.global&&f.assumeGlobal&&(s=d,p=e.GlobalRule,m=[]);if(f.assumeGlobal&&!p&&(p=e.GlobalRule,m=m||[],s=s||d),!s||!p)throw new Error("Missing verb or verb object");var w=(c=v)[(r.modifiers.some?"some":r.modifiers.every&&"every")||"can"].apply(c,[u(),s,p].concat(m)),G=r.modifiers.not,j=t;t.hasAttribute("disabled")||(j.disabled=!1),t.hasAttribute("readOnly")||(j.readOnly=!1),(w&&G||!w&&!G)&&("hide"===y?function(e,t){var r=document.createComment(" ");Object.defineProperty(r,"setAttribute",{value:function(){}}),t.text=" ",t.elm=r,t.isComment=!0,t.tag=void 0,t.data=t.data||{},t.data.directives=void 0,t.componentInstance&&(t.componentInstance.$el=r),e.parentNode&&e.parentNode.replaceChild(r,e)}(t,i):"disable"===y?j.disabled=!0:"readonly"===y&&(j.readOnly=!0))};if([f.directive].concat(f.aliases).forEach(function(e){return t.directive(e,p)}),f.helper){var m="$"+f.directive;t.prototype[m]=function(e,t){var r;return(r=v).can.apply(r,[u(),e,t].concat([].slice.call(arguments,2)))},t.prototype[m].not=function(e,t){var r;return!(r=v).can.apply(r,[u(),e,t].concat([].slice.call(arguments,2)))},t.prototype[m].every=function(e,t){var r;return(r=v).every.apply(r,[u(),e,t].concat([].slice.call(arguments,2)))},t.prototype[m].some=function(e,t){var r;return(r=v).some.apply(r,[u(),e,t].concat([].slice.call(arguments,2)))}}}},r=function(e){return function(t){return[e.directive].concat(e.aliases||[]).map(function(e){return t[e]}).filter(Boolean).shift()}},o=function(e){var t=e.arg,r=e.value;return[t||r[0],t?r[0]:r[1],r.slice(t?1:2)]},a=function(t){var r=t.arg,o=t.value;return[r||o[0],e.GlobalRule,r?o:o.slice(1)]},n=function(e,t,r){var o=e.arg,a=e.value,n=e.modifiers,i=o?[o,a]:a.split(" "),l=i[0],c=i[1];if(c&&n.global)throw new Error("You cannot provide verb object and use global modifier at the same time");return"string"==typeof c&&r.caseMode&&c[0].match(/[a-z]/)&&"object"==typeof t.context&&(c=t.context.$data[c]),[l,c,[]]};export default t;
//# sourceMappingURL=index.module.js.map
