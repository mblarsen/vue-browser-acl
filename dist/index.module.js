import e from"browser-acl";var t={install:function(t,c,u,s){void 0===u&&(u=void 0),void 0===s&&(s={});var f="function"==typeof c?c:function(){return c},d=Boolean(s.strict),v=Object.assign({acl:{strict:d},aliases:["role"],assumeGlobal:!d,caseMode:!0,debug:!1,directive:"can",failRoute:"/",helper:!0,strict:!1},s),m=o(v),p=new e(v.acl);"function"==typeof u?u(p):u instanceof e&&(p=u),p.router=function(t){v.router=t;var r=function(e,t){var r;return t&&(r=p).can.apply(r,[f(),e,t].concat([].slice.call(arguments,2)))||!t&&!v.strict};t.beforeEach(function(t,n,o){var a=function(t,n,o){var a=null,i=t.reduce(function(t,i){return t.then(function(t){if(!0!==t)return t;"string"==typeof i.fail&&(a=i.fail);var l,c,u=m(i),s="function"==typeof u?u(n,o,r):Promise.resolve(r.apply(void 0,[(l=u.split(" "))[0],void 0===(c=l[1])?v.assumeGlobal?e.GlobalRule:null:c]));if(v.strict&&!(s instanceof Promise))throw new Error("$route.meta.can must return a promise in strict mode");return s}).catch(function(e){return v.debug&&console.error(e),!1})},Promise.resolve(!0));return i.getFail=function(){return a},i}(t.matched.filter(function(e){return e.meta&&m(e.meta)}).map(function(e){return e.meta}),t,n);a.then(function(e){if(!0===e)return o();var r=a.getFail()||v.failRoute;"$from"===r&&(r=n.path),o("function"==typeof r?r(t,n):r)})})},v.router&&p.router(v.router);var y=function(t,o,c){var u,s,d,m,y,b,h=void 0!==(b=o.modifiers).disable?"disable":void 0!==b.readonly?"readonly":"hide";if(d=o.arg,Array.isArray(o.value)&&o.expression.startsWith("[")){var g=o.modifiers.global?i(o):a(o);s=g[0],m=g[1],y=g[2]}else if("string"==typeof o.value){var E=l(o,c,v);s=E[0],m=E[1],y=E[2]}else d&&"object"==typeof o.value?(s=d,m=o.value,y=[]):void 0===o.value&&!o.modifiers.global&&v.assumeGlobal&&(s=d,m=e.GlobalRule,y=[]);if(v.assumeGlobal&&!m&&(m=e.GlobalRule,y=y||[],s=s||d),!s||!m)throw new Error("Missing verb or subject");var M=(u=p)[(o.modifiers.some?"some":o.modifiers.every&&"every")||"can"].apply(u,[f(),s,m].concat(y)),T=o.modifiers.not,G=function(e){return!!r.some(function(t){return e instanceof t})&&e}(t),H=function(e){return!!n.some(function(t){return e instanceof t})&&e}(t);G&&(G.disabled=!1),H&&(H.readOnly=!1),(M&&T||!M&&!T)&&("hide"===h?function(e,t){var r=document.createComment(" ");Object.defineProperty(r,"setAttribute",{value:function(){}}),t.text=" ",t.elm=r,t.isComment=!0,t.tag=void 0,t.data=t.data||{},t.data.directives=void 0,t.componentInstance&&(t.componentInstance.$el=r),e.parentNode&&e.parentNode.replaceChild(r,e)}(t,c):"disable"===h&&G?G.disabled=!0:"readonly"===h&&H&&(H.readOnly=!0))};if([v.directive].concat(v.aliases).forEach(function(e){return t.directive(e,y)}),v.helper){var b="$"+v.directive;t.prototype[b]=function(e,t){var r;return(r=p).can.apply(r,[f(),e,t].concat([].slice.call(arguments,2)))},t.prototype[b].not=function(e,t){var r;return!(r=p).can.apply(r,[f(),e,t].concat([].slice.call(arguments,2)))},t.prototype[b].every=function(e,t){var r;return(r=p).every.apply(r,[f(),e,t].concat([].slice.call(arguments,2)))},t.prototype[b].some=function(e,t){var r;return(r=p).some.apply(r,[f(),e,t].concat([].slice.call(arguments,2)))}}}},r=[HTMLButtonElement,HTMLFieldSetElement,HTMLInputElement,HTMLOptGroupElement,HTMLOptionElement,HTMLSelectElement,HTMLTextAreaElement],n=[HTMLInputElement,HTMLTextAreaElement],o=function(e){return function(t){return[e.directive].concat(e.aliases||[]).map(function(e){return t[e]}).filter(Boolean).shift()}},a=function(e){var t=e.arg,r=e.value;return[t||r[0],t?r[0]:r[1],r.slice(t?1:2)]},i=function(t){var r=t.arg,n=t.value;return[r||n[0],e.GlobalRule,r?n:n.slice(1)]},l=function(e,t,r){var n=e.arg,o=e.value,a=e.modifiers,i=n?[n,o]:o.split(" "),l=i[0],c=i[1];if(c&&a.global)throw new Error("You cannot provide subject and use global modifier at the same time");return"string"==typeof c&&r.caseMode&&c[0].match(/[a-z]/)&&"object"==typeof t.context&&(c=t.context.$data[c]),[l,c,[]]};export default t;
//# sourceMappingURL=index.module.js.map
